## 问题分析

当用户选择"所有班级"模式时，Excel导入功能出现问题：

1. `currentClass`变量的值为`'all_classes'`
2. 在`handleExcelImport`函数中，`targetClassId`被设置为`'all_classes'`
3. 学生的`classId`被设置为`'all_classes'`
4. 由于`classes`数组中没有ID为`'all_classes'`的班级，学生显示为"未知班级"
5. 此外，在覆盖模式下，当`currentClass`为`'all_classes'`时，所有导入的学生的`classId`都被设置为`'all_classes'`

## 修复方案

修改`handleExcelImport`和`executeImport`函数，确保在"所有班级"模式下：

1. 学生被正确添加到Excel中指定的班级
2. 如果Excel中没有指定班级，提示用户选择一个班级
3. 在覆盖模式下，不允许使用"所有班级"模式

## 具体修改步骤

1. 修改`handleExcelImport`函数：

   * 当`currentClass`为`'all_classes'`且Excel中没有指定班级时，提示用户选择一个班级

   * 确保`targetClassId`始终是一个有效的班级ID

2. 修改`executeImport`函数：

   * 在覆盖模式下，不允许使用"所有班级"模式

   * 确保学生的`classId`始终是一个有效的班级ID

3. 修改`importExcel`函数：

   * 在覆盖模式下，检查当前是否为"所有班级"模式，如果是则提示用户选择一个具体班级

4. 测试修复后的功能

## 代码修改点

1. **handleExcelImport函数**：

   * 在第1013行附近添加逻辑，处理`currentClass`为`'all_classes'`的情况

   * 确保`targetClassId`始终是一个有效的班级ID

2. **executeImport函数**：

   * 在第1106行附近添加逻辑，检查覆盖模式下的`currentClass`值

   * 确保学生被添加到正确的班级

3. **importExcel函数**：

   * 在调用`showImportModeModal`前，检查当前是否为"所有班级"模式

   * 如果是覆盖模式，提示用户选择一个具体班级

